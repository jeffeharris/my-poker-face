# T1-20: SQL Injection in Admin Dashboard — RE-VERIFY

## Finding
TRIAGE claimed SQL injection risk at `admin_dashboard_routes.py:1724` where table names are interpolated via f-string.

## Analysis

### Code Path
1. `categories` is a **hardcoded dictionary** defined at lines 1680-1697 with fixed table names
2. `allowed_tables` is built from `categories.values()` plus the literal `'experiments'` (lines 1700-1704) — entirely server-controlled
3. `tables` is read from `sqlite_master` (line 1715) — these are actual database table names, not user input
4. **Whitelist check at line 1719**: `if table not in allowed_tables: continue` — skips any table not in the hardcoded set
5. The f-string interpolation at line 1724 (`f'SELECT COUNT(*) as cnt FROM "{table}"'`) only executes for whitelisted table names
6. Line 1730 also uses f-string for the same `table` variable (already validated), and the WHERE clause uses parameterized query (`?`)

### Bypass Analysis
- No user input flows into `categories` or `allowed_tables`
- The `table` variable comes from `sqlite_master`, not from request parameters
- The whitelist is applied unconditionally before any f-string interpolation
- There is no early return, exception, or goto that could skip the whitelist check

### Other f-string SQL in file
Grep found only two f-string SQL patterns in the entire file, both inside the same whitelist-guarded loop.

## Verdict
**Dismissed — false positive.** The whitelist guard is robust: `allowed_tables` is hardcoded, the check is unconditional, and there is no bypass path. Table names cannot be parameterized in SQLite, so a whitelist is the correct defensive approach.
