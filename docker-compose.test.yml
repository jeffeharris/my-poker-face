# Override for E2E testing: TEST_MODE backend + Playwright runner.
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.test.yml up --build --exit-code-from playwright playwright
#
services:
  backend:
    environment:
      - TEST_MODE=true

  frontend:
    environment:
      - VITE_BACKEND_PORT=5173
      # Vite proxy forwards /api and /socket.io to backend
      - VITE_BACKEND_URL=http://backend:5000

  playwright:
    build:
      context: ./react/react
      dockerfile: Dockerfile.playwright
    environment:
      - CI=true
      - BASE_URL=http://frontend:5173
      - BACKEND_URL=http://backend:5000
    depends_on:
      backend:
        condition: service_healthy
      frontend:
        condition: service_started
    networks:
      - poker-network
